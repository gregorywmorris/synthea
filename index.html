<script>
    document.getElementById('syntheaForm').addEventListener('submit', function(event) {
        event.preventDefault();

        // Collect form data
        const formData = new FormData(event.target);
        let command = './run_synthea';

        // Append form data to command
        for (let [key, value] of formData.entries()) {
            if (value) {
                switch(key) {
                    case 'state':
                    case 'city':
                        command += ` ${value}`;
                        break;
                    case 'configValue':
                        command += ` --config=${value}`;
                        break;
                    default:
                        command += ` -${key.charAt(0)} ${value}`;
                }
            }
        }

        // Send command to backend
        fetch('http://localhost:5000/run-synthea', {
            method: 'POST',
            body: JSON.stringify({ command: command }),
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert('Error: ' + data.error);
            } else {
                alert('Command Output: ' + data.output);
                if (data.returncode !== 0) {
                    alert('Error Output: ' + data.error);
                }
            }
        })
        .catch(error => console.error('Error:', error));
    });
</script>
